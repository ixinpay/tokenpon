<div class="container">
    <div class="row">
        <div class="form-group col-md-9 no-gutters">
            <label for="businessCategory" translate>{{model.businessMainCategory}}</label> >
            <label for="businessCategory" class="inline" translate>{{model.businessSubCategory}}</label>
            <div class="text-center">
                <button class="btn defaultbtn btn-md" [hidden]="!isAuthor" translate [routerLink]="['/home/claim']"
                    [queryParams]="{id: claimId}">Edit</button>
                <button class="btn btn-danger btn-md" [hidden]="!isAuthor" translate (click)="Remove_Listing(claimId, deleteConfirmation)">Delete</button>

                <div>
                    <!-- {{model.commentsNum + " Reviews"}} -->
                </div>
                <!-- 
            <br>
            <label for="email">{{model.email}}</label>
            <br>
            <a [href]="formatURL(model.webPage)" target="_blank">{{model.webPage}}</a> -->
            </div>
            <div>
                <h5>{{model.businessName}} - {{model.city}}</h5>
            </div>
            <!-- <div class="mt-3">
                <h6 translate>{{model.overallTitle}}</h6>
            </div>
            <div>
                <div class="mt-3">
                    <h4 translate>Highlights</h4>
                    <hr align="left">
                    <div translate>{{model.productDescription}}</div>

                </div>
            </div> -->
            <!-- <div class="row">
                    <div class="col-lg-8 offset-lg-2" id="slider">
                            <div id="myCarousel" class="carousel slide">
                                <div class="carousel-inner">
                                    <div class="active item carousel-item" data-slide-number="0">
                                        <img src="http://placehold.it/1200x480&amp;text=one" class="img-fluid">
                                    </div>
                                    <div class="item carousel-item" data-slide-number="1">
                                        <img src="http://placehold.it/1200x480/888/FFF" class="img-fluid">
                                    </div>
                                    <div class="item carousel-item" data-slide-number="2">
                                        <img src="http://placehold.it/1200x480&amp;text=three" class="img-fluid">
                                    </div>
                                    <div class="item carousel-item" data-slide-number="3">
                                        <img src="http://placehold.it/1200x480&amp;text=four" class="img-fluid">
                                    </div>
                                    <div class="item carousel-item" data-slide-number="4">
                                        <img src="http://placehold.it/1200x480&amp;text=five" class="img-fluid">
                                    </div>
                                    <a class="carousel-control left pt-3" href="#myCarousel" data-slide="prev"><i class="fa fa-chevron-left"></i></a>
                                    <a class="carousel-control right pt-3" href="#myCarousel" data-slide="next"><i class="fa fa-chevron-right"></i></a>
            
                                </div>
                                
            
                                <ul class="carousel-indicators list-inline">
                                    <li class="list-inline-item active">
                                        <a id="carousel-selector-0" class="selected" data-slide-to="0" data-target="#myCarousel">
                                            <img src="http://placehold.it/80x60&amp;text=one" class="img-fluid">
                                        </a>
                                    </li>
                                    <li class="list-inline-item">
                                        <a id="carousel-selector-1" data-slide-to="1" data-target="#myCarousel">
                                            <img src="http://placehold.it/80x60&amp;text=two" class="img-fluid">
                                        </a>
                                    </li>
                                    <li class="list-inline-item">
                                        <a id="carousel-selector-2" data-slide-to="2" data-target="#myCarousel">
                                            <img src="http://placehold.it/80x60&amp;text=three" class="img-fluid">
                                        </a>
                                    </li>
                                    <li class="list-inline-item">
                                        <a id="carousel-selector-3" data-slide-to="3" data-target="#myCarousel">
                                            <img src="http://placehold.it/80x60&amp;text=four" class="img-fluid">
                                        </a>
                                    </li>
                                    <li class="list-inline-item">
                                        <a id="carousel-selector-4" data-slide-to="4" data-target="#myCarousel">
                                            <img src="http://placehold.it/80x60&amp;text=five" class="img-fluid">
                                        </a>
                                    </li>
                                </ul>
                        </div>
                    </div>
            
                </div> -->
            <div class="row mt-2">
                <ngu-carousel #myCarousels1 class="col-12" [inputs]="carouselBanner" (carouselLoad)="carouselTileOneLoad()" (onMove)="onMoveData($event)"
                    [reset]="rsts" (initData)="getCarouselData($event)">
                    <ngu-tile NguCarouselItem *ngFor="let image of albums; let i=index">
                        <img style="cursor: pointer;width: 100%;height: 100px;" [src]="image.thumb" (click)="open(i)"
                            class="img-thumbnail hoverable" />
                    </ngu-tile>
                    <a NguCarouselPrev class="carousel-control-prev">
                        <i class="fa fa-chevron-left fa-lg text-muted pt-5"></i>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a NguCarouselNext class="carousel-control-next text-faded">
                        <i class="fa fa-chevron-right fa-lg text-muted pt-5"></i>
                        <span class="sr-only">Next</span>
                    </a>
                </ngu-carousel>
            </div>
            <div class="col-12 mb-2" *ngFor="let field of discountArray; let i = index">
                <div class="card">
                    <div class="col-12">
                        <div class="card-block">
                            <div class="row">
                                <div class="col-8">
                                    <h4 class="offer-head">OFFER {{i+1}}</h4>
                                </div>
                                <div class="col-4 text-center">
                                    <button type="button" class="btn defaultbtn" (click)="displayBuyModal(content, i, finalConfirm);">BUY</button>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12 col-sm-12 col-md-2">Title:</div>
                                <div class="col-xs-12 col-sm-12 col-md-10">
                                    {{field.title}}
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12 col-sm-12 col-md-2">Description:</div>
                                <div class="col-xs-12 col-sm-12 col-md-10">
                                    {{field.description}}
                                </div>
                            </div>
                            <div class="divTable darkTable">
                                <div class="divTableHeading">
                                    <div class="divTableHeadRow">
                                        <div class="divTableHead">Amount Spend</div>
                                        <div class="divTableHead">Discount</div>
                                        <div class="divTableHead">Token Number</div>
                                    </div>
                                </div>
                                <div class="divTableBody">
                                    <div class="divTableRow">
                                        <div class="divTableCell">{{field.amount}}</div>
                                        <div class="divTableCell">{{field.discount * 100}}%</div>
                                        <div class="divTableCell">{{field.token}}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3 no-gutters">
            <div>
                <h4 translate>General Info</h4>
                <hr align="left">
                <agm-map [latitude]="lat" [longitude]="lng" [zoom]="zoom" [streetViewControl]="false">
                    <agm-marker *ngFor="let m of markers; let i = index" (markerClick)="clickedMarker(m.label, i)"
                        [latitude]="m.lat" [longitude]="m.lng" [label]="" [markerDraggable]="m.draggable" (dragEnd)="markerDragEnd(m, $event)">
                    </agm-marker>
                </agm-map>
                <ul class="small">
                    <li>
                        <i class="fas fa-map-marker-alt"></i>
                        <span style="padding-left:10px">{{model.street}} {{model.city}},
                            {{model.state}} {{model.zip}}</span>
                    </li>
                    <li>
                        <i class="fas fa-phone"></i><span style="padding-left:10px">{{model.phone}}</span>
                    </li>
                    <li>
                        <i class="fas fa-envelope"></i><span style="padding-left:10px">{{model.email}}</span>
                    </li>
                    <li>
                        <i class="fas fa-globe"></i><span style="padding-left:10px"><a [href]=" formatURL(model.webPage) "
                                target="_blank ">{{model.webPage}}</a></span>
                    </li>
                </ul>
            </div>
        </div>
        <div class="form-group col-md-9 no-gutters">
            <div *ngIf="!currentUser">
                <div class="row col-12">
                    <i class="far fa-thumbs-up fa-lg col-6">
                        <i style="font-size: medium;">{{likes}} likes</i>
                    </i>
                    <i class="far fa-thumbs-down fa-lg col-6">
                        <i style="font-size: medium;">{{dislikes}} dislikes</i>
                    </i>
                </div>
            </div>
            <div *ngIf="currentUser != undefined">
                <div class="row col-12">
                    <i (click)="thumbsUp()" [ngClass]="{ 'fa-thumbs-up-clicked': alreadyLiked }" class="far fa-thumbs-up fa-lg col-6"
                        placement="top" ngbTooltip="you liked it">
                        <i style="font-size: medium;">{{likes}} likes</i>
                        <br>
                        <label style="font-size: small" translate>(earn 5 tokens)</label>
                    </i>
                    <i (click)="thumbsDown()" [ngClass]="{ 'fa-thumbs-down-clicked': alreadyDisliked }" class="far fa-thumbs-down fa-lg col-6"
                        placement="top" ngbTooltip="you didn't like it">
                        <i style="font-size: medium;">{{dislikes}} dislikes</i>
                        <br>
                        <label style="font-size: small" translate>(to dislike costs 10 tokens)</label>
                    </i>
                </div>
            </div>
        </div>
        <div class="form-group col-md-9 no-gutters">
            <h4 translate>Fine Print</h4>
            <hr align="left">
            <div translate>{{model.finePrint}}</div>

        </div>
        <div class="form-group col-md-9 no-gutters">
            <h4 translate>About {{model.businessName}}</h4>
            <hr align="left">
            <div translate>{{model.service}}</div>

        </div>
        <div class="form-group col-md-9 no-gutters">
            <h4 translate>Reviews</h4>
            <hr align="left">
            <div class="form-group">
                <div>
                    <form #commentForm="ngForm" (ngSubmit)="onSubmit(commentText.value); commentForm.reset();">
                        <label for="commentTextarea" translate>Your comment (min 10 characters):</label>
                        <br>
                        <textarea class="form-control comment-post" [ngModel]="comment" name="comment" 
                            required minlength="10" id="commentTextarea" #commentText="ngModel"></textarea>
                        <br>
                        <div>
                            <button class="btn btn-primary btn-sm" [disabled]="!commentForm.form.valid" translate>Submit</button>
                        </div>
                        <!-- <textarea class="form-control" [ngModel]="ownComment?.comment" name="comment" required
                            minlength="10" rows="3" id="commentTextarea" #commentText="ngModel"></textarea>
                        <br>
                        <div *ngIf="!ownComment">
                            <button class="btn btn-primary btn-sm" [disabled]="!commentForm.form.valid" translate>Submit</button>
                        </div>
                        <div *ngIf="ownComment">
                            <button class="btn btn-primary btn-sm" [disabled]="!commentForm.form.valid || commentText.pristine"
                                translate>Update</button>
                        </div> -->
                    </form>
                </div>
            </div>

            <ul>
                <li *ngFor="let c of commentsPage">
                    <div class="row col-12">
                        <div class="col-sm-11">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <i class="fa fa-user-circle fa-2x"></i> <span class="username">{{c.postedBy}}</span>
                                    <span class="text-muted float-right">posted on {{c.postedTime | date
                                        :'medium'}}</span>
                                </div>
                                <div class="panel-body">
                                    {{c.comment}}
                                </div>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
            <ngb-pagination [collectionSize]="totalItems" [(page)]="page" [maxSize]="maxSize" [pageSize]="pageSize"
                [rotate]="true" (pageChange)="loadPage($event)"></ngb-pagination>
        </div>
    </div>
</div>
<!-- Modal -->
<ng-template #content let-d="dismiss">
    <!-- <div class="modal-header">
            <button type="button" class="close" aria-label="Close" (click)="d()">
                <span aria-hidden="true">&times;</span>
            </button>
        </div> -->
    <div class="modal-body">
        <p translate>{{discountTokenCost}} iXin coin will be withdrawn from your account. Your purchase will be shown
            on Your
            iXin Pay Mobile App.
        </p>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="d('Cancel')">Cancel</button>
        <button type="button" class="btn btn-primary" (click)="d('Confirm');">Confirm</button>
    </div>
</ng-template>

<ng-template #finalConfirm let-d="dismiss">
    <!-- <div class="modal-header">
                <button type="button" class="close" aria-label="Close" (click)="d()">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div> -->
    <div class="modal-body">
        <p *ngIf="modalSuccess" translate>Success! Enjoy your discount!.
        </p>
        <p *ngIf="!modalSuccess" translate>{{failMessage}}
        </p>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="d()">OK</button>
    </div>
</ng-template>
<ng-template #deleteConfirmation let-d="dismiss">
    <div class="modal-body">
        <p translate>Are you sure you want to delete this listing?
        </p>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="d('No')">No</button>
        <button type="button" class="btn btn-danger" (click)="d('Yes');">Yes</button>
    </div>
</ng-template>